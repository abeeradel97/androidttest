define(["require","exports","tslib","react","draft-js","spectrum_comments/comment_editor/components/readonly_draft_component","spectrum_comments/comment_editor/core/editor_component"],function(t,e,o,n,r,i,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a;(function(t){t[t.ENTER=13]="ENTER",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN"})(a||(a={}));var l=[a.ESC,a.SPACE,a.UP,a.RIGHT,a.DOWN],d=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollClassName="sc-comment-editor-draft",e.onChange=function(t){e.triggers.draft.change(t)},e.handleReturn=function(t,o){if(t.metaKey||t.ctrlKey){return!(""===o.getCurrentContent().getPlainText().trim())&&e.triggers.comment&&(e.blurEditor(),e.triggers.comment.post(o)),"handled"}return e.triggers.draft.returnKey(t).editorState!==o||e.status.macro.active?(t.preventDefault(),"handled"):"not-handled"},e.onScroll=function(t){if(e.status.macro.macroRef){var o=e.triggers.macro.updateVisibility,n=t.target;o(e.getMacroVisibilityFromScrollEl(n))}},e.keyBindingFn=function(t){var o=e.props.customKeyBinding;if(e.isNavigationalKeyboardEvent(t)){var n=e.status.suggestion;if(!e.isVacuousSuggestion(n)&&(e.triggers.draft.key(t),n!==e.status.suggestion))return t.preventDefault(),null}return o?o(t):r.getDefaultKeyBinding(t)},e.handleKeyCommand=function(t,o){return e.triggers.draft.keyCommand(t).editorState===o?"not-handled":"handled"},e.handleBeforeInput=function(t,o){return e.triggers.draft.input(t).editorState===o?"not-handled":"handled"},e.handlePastedText=function(t,o,n){var r=n;return r=e.triggers.draft.pasteText(t).editorState,o&&r===n&&(r=e.triggers.draft.pasteHTML({text:t,html:o}).editorState),r===n?"not-handled":"handled"},e.handleCompositionStart=function(t){e.triggers.draft.compositionStart(t)},e.handleCompositionEnd=function(t){e.triggers.draft.compositionEnd(t)},e.onKeyDown=function(t){if(e.isNavigationalKeyboardEvent(t)){var o=e.status.suggestion;e.triggers.draft.key(t),e.status.suggestion!==o&&t.preventDefault()}else t.which===a.SPACE?e.triggers.draft.key(t):t.which===a.ENTER&&e.status.macro.active&&t.preventDefault()},e.onMouseDown=function(t){var o=e.props.handleFocus;o&&o(t)},e.onMouseUp=function(t){var o=e.props.handleFocus;o&&o(t)&&e.onFocus(t)},e.onFocus=function(t){var o=e.props.handleFocus;if(o&&!o(t))return t.preventDefault(),void t.stopPropagation();e.triggers.macro.updateVisibility(e.getMacroVisibilityFromScrollEl(e.getScrollEl(t.target))),e.triggers.draft.focus(t)},e.onBlur=function(t){e.triggers.macro.updateVisibility(!1),e.triggers.draft.blur(t)},e.onTab=function(t){e.triggers.draft.key(t)},e.blockRendererFn=function(t){var o=t.getType();if(o&&e.status.draft.blockRenderers[o])return e.status.draft.blockRenderers[o](t)},e}return o.__extends(e,t),e.prototype.blurEditor=function(){this.editor.blur()},e.prototype.focusEditor=function(){this.editor.focus()},e.prototype.getMacroVisibilityFromScrollEl=function(t){if(!this.status.macro.macroRef)return!1;var e=t.getBoundingClientRect(),o=this.status.macro.macroRef.getBoundingClientRect();return o.bottom<e.bottom&&o.top>e.top},e.prototype.getScrollEl=function(t){if(null===t)throw new Error("Unable to find scroll element");return t.classList.contains(this.scrollClassName)?t:this.getScrollEl(t.parentElement)},e.prototype.isVacuousSuggestion=function(t){return 0===t.totalSuggestions},e.prototype.isNavigationalKeyboardEvent=function(t){var e=t.which;return l.indexOf(e)>-1},e.prototype.componentDidMount=function(){this.props.shouldFocus&&this.editor&&this.focusEditor()},e.prototype.componentDidUpdate=function(t){var e=t.shouldFocus;this.props.shouldFocus&&!e&&this.editor&&this.focusEditor()},Object.defineProperty(e.prototype,"accessibilityProps",{get:function(){var t=this.status,e=t.macro,o=t.suggestion,n=e.active,r=e.isVisible,i=o.selectedIndex,s=!(!n||!n.chrome),a=s&&r;return{role:"combobox",ariaAutocomplete:"list",ariaExpanded:a,ariaActiveDescendantID:i!==-1&&a?"mentions-option-"+i:""}},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this,e=this.status.draft,r=e.editorState,s=e.readOnly,a=e.placeholder,l=e.isComposing,d=this.props,u=d.annotation,c=d.spellCheck,p=d.a11yEditorLabel,g=o.__assign({ariaLabel:p,readOnly:s,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onTab:this.onTab,handleReturn:this.handleReturn,keyBindingFn:this.keyBindingFn,handleKeyCommand:this.handleKeyCommand,handleBeforeInput:this.handleBeforeInput,handlePastedText:this.handlePastedText,blockRendererFn:this.blockRendererFn},this.accessibilityProps),f=""===r.getCurrentContent().getPlainText(),h=f&&!l?n.createElement("span",{className:"sc-comment-editor-placeholder",tabIndex:-1},a):void 0;return n.createElement("div",{className:this.scrollClassName,onScroll:this.onScroll,onKeyDown:this.onKeyDown,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},n.createElement(i.ReadonlyDraftComponent,o.__assign({draftRef:function(e){t.editor=e}},g,{annotation:u,editorPlaceholder:h,spellCheck:c})))},e})(s.EditorComponent);e.DraftComponent=d});
//# sourceMappingURL=draft_component.min.js-vflxFV3fZ.map