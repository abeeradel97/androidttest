define(["require","exports","tslib","react","spectrum_comments/rich_facepile/localization","spectrum/avatar","spectrum/facepile","spectrum/util/uuid_generator","spectrum_comments/rich_facepile/leave_active_mode_wrapper"],function(e,o,t,n,i,a,r,l,c){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.OVERFLOW="overflow",o.MAX_FACES=5;var s;(function(e){e[e.Auto=1]="Auto",e[e.ForceShow=2]="ForceShow",e[e.ForceHide=3]="ForceHide"})(s=o.DisplayMode||(o.DisplayMode={}));var p=(function(e){function p(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.tooltipContentWrapperClassName=l.generateUUID("sc-rich-facepile-tooltip-content"),t.documentClickListener=function(e){var o=e.target;void 0===t.state.activeTooltipIndex||t.closest(o,t.tooltipContentWrapperClassName)||t.closest(o,"mc-facepile-container")||t.setState({activeTooltipIndex:void 0})},t.windowResizeListener=function(){t.state.activeTooltipIndex&&t.leaveActiveMode()},t.leaveActiveMode=function(){t.setState({activeTooltipIndex:void 0})},t.bindN=function(e){for(var t=[],n=function(o){t.push(function(){return e(o)})},i=0;i<o.MAX_FACES;i++)n(i);return t},t.onTooltipShownForIndex=function(e){var o=t.props.onTooltipChange,n=t.infoFromIndex(e);o&&null!==n&&o({activeMode:t.activeMode,displayInfo:null},{activeMode:t.activeMode,displayInfo:n})},t.onTooltipHiddenForIndex=function(e){var o=t.props.onTooltipChange,n=t.infoFromIndex(e);o&&null!==n&&o({activeMode:t.activeMode,displayInfo:n},{activeMode:t.activeMode,displayInfo:null})},t.onAvatarClickForIndex=function(e){var n=t.props,i=n.becomePassiveOnOverflowAvatarClick,a=n.onAvatarClick,r=n.onTooltipChange,l=t.infoFromIndex(e),c=i&&l===o.OVERFLOW;c||t.activeMode||(t.setState({activeTooltipIndex:e}),r&&r({activeMode:!1,displayInfo:null},{activeMode:!0,displayInfo:l})),c&&t.activeMode&&(t.setState({activeTooltipIndex:void 0}),r&&r({activeMode:!0,displayInfo:o.OVERFLOW},{activeMode:!1,displayInfo:null})),l&&a&&a(l)},t.onAvatarMouseOverForIndex=function(e){void 0!==t.state.activeTooltipIndex&&t.setState({activeTooltipIndex:e})},t.onTooltipShown=t.bindN(t.onTooltipShownForIndex),t.onTooltipHidden=t.bindN(t.onTooltipHiddenForIndex),t.onAvatarClick=t.bindN(t.onAvatarClickForIndex),t.onAvatarMouseOver=t.bindN(t.onAvatarMouseOverForIndex),t}return t.__extends(p,e),p.prototype.componentDidMount=function(){document.addEventListener("click",this.documentClickListener,!0),window.addEventListener("resize",this.windowResizeListener,!0)},p.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.documentClickListener,!0),window.removeEventListener("resize",this.windowResizeListener,!0)},p.prototype.closest=function(e,o){for(;e;e=e.parentElement)if(e.classList.contains(o))return e;return null},Object.defineProperty(p.prototype,"activeMode",{get:function(){return void 0!==this.state.activeTooltipIndex},enumerable:!0,configurable:!0}),p.prototype.displayModeForIndex=function(e){var o=this.state.activeTooltipIndex;return void 0===o?s.Auto:o===e?s.ForceShow:s.ForceHide},p.prototype.infoFromIndex=function(e){var t=this.props,n=t.avatarInfoList,i=t.avatarInfoList.length;return t.overflowRemainderCount&&e===i?o.OVERFLOW:e>=i?null:n[e]},p.prototype.render=function(){var e=this,t=this.props,i=t.avatarSize,l=t.avatarInfoList,s=t.overflowRemainderCount,p=t.tooltipComponent,d=t.renderFacepile,v=l.map(function(o,t){var l=o.present,s=o.activeTooltipContent,d=o.avatarColorSeed,v=o.displayName,u=o.initials,f=o.memberKey,m=o.passiveTooltipContent,C=o.photoUrl,h=d||v,M=n.createElement("div",{onFocusCapture:e.onAvatarMouseOver[t]},n.createElement(r.FacepileMembersAvatar,{active:l,"aria-label":v,avatarColorSeed:h,avatarSize:i,initials:u,onClick:e.onAvatarClick[t],onMouseOver:e.onAvatarMouseOver[t],photoUrl:C})),I=e.activeMode?n.createElement(c.LeaveActiveModeWrapperContext.Provider,{value:{signalClick:e.leaveActiveMode}},s||m):m;return n.createElement(p,{avatar:M,displayMode:e.displayModeForIndex(t),tooltipContent:I,avatarColor:a.avatarColorForUserIdentifier(h),onTooltipShown:e.onTooltipShown[t],onTooltipHidden:e.onTooltipHidden[t],tooltipContentWrapperClassName:e.tooltipContentWrapperClassName,key:f})}),u=this.context.localization;if(s){var f=l.length,m=s>=99?u.ninetyNinePlus:""+s,C=n.createElement("div",{onFocusCapture:this.onAvatarMouseOver[f]},n.createElement(r.FacepileMembersOverflowCircle,{avatarSize:i,backgroundColor:"#627283",textColor:"white",onClick:this.onAvatarClick[f],onMouseOver:this.onAvatarMouseOver[f],remainderCount:m}));v.push(n.createElement(p,{avatar:C,displayMode:this.displayModeForIndex(f),tooltipContent:n.createElement("div",{className:"sc-rich-facepile-overflow-tooltip-content"},this.context.localization.nOthers(s,m)),avatarColor:"#627283",onTooltipShown:this.onTooltipShown[f],onTooltipHidden:this.onTooltipHidden[f],tooltipContentWrapperClassName:this.tooltipContentWrapperClassName,key:o.OVERFLOW}))}return d(v)},p.contextType=i.RichFacepileContext,p})(n.Component);o.Avatars=p});
//# sourceMappingURL=avatars.min.js-vflh19ZwT.map